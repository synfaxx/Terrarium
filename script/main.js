const e=document.querySelector(".main__flex"),t=document.querySelector("#count"),l=document.querySelector("#start"),i=function(e,t){let l=Math.floor(e),i=e.toString(),o=i.indexOf(".");if("."==i.charAt(i.length-1))return l;if(i.substr(o+1).length<=t)return e;for(let e=0;e<t;e++)l+=+i.charAt(e+o+1)/10**(e+1);return l},o=function(){let t=e.clientWidth;if(t!==e.clientHeight){document.querySelector(".main__map").style.height=t+"px";let e=i(t/document.querySelectorAll(".item").length**.5,3);document.querySelectorAll(".item").forEach((t=>{t.style.width=e+"px",t.style.height=e+"px"}))}};o();const r=function(e={type:"toggle"}){document.querySelector(".loading").classList[e.type]("loading_show"),document.body.classList[e.type]("lock")},n=function(e){let t=e.getAttribute("data-pos").split("-"),l=+t[0],i=+t[1];if(e.classList.contains("item_life")){let t=0;for(let e=l-1;e<l+2;e++)for(let o=i-1;o<i+2;o++){let r=document.querySelector(`.item[data-pos="${e}-${o}"]`);!r||e===l&&o===i||r&&r.classList.contains("item_life")&&t++}2!==t&&3!==t&&e.classList.add("item_dead-after")}else{let t=0;for(let e=l-1;e<l+2;e++)for(let o=i-1;o<i+2;o++){let r=document.querySelector(`.item[data-pos="${e}-${o}"]`);!r||e===l&&o===i||r.classList.contains("item_life")&&t++}3===t&&e.classList.add("item_life-after")}},a=function(){document.querySelectorAll(".item_life-after").forEach((e=>{e.classList.add("item_life"),e.classList.remove("item_life-after")})),document.querySelectorAll(".item_dead-after").forEach((e=>{e.classList.remove("item_life"),e.classList.remove("item_dead-after")}))};let s=!1;const c=function(){s||(value=parseInt(t.value),"number"!=typeof value||isNaN(value)||value<=7||value>=31||(s=!0,clearInterval(u),document.querySelector(".main__map").classList.remove("main__map_border"),r(),setTimeout((()=>{let t=i(e.clientWidth/value,3);e.innerHTML="";for(let i=0;i<value;i++)for(let o=0;o<value;o++){let r=(l=2.2,0==Math.round(Math.random()*l))?" item_life":"";e.innerHTML+=`<div class="item${r}" data-pos="${o}-${i}" style="width: ${t}px; height: ${t}px;"></div>`}var l;setTimeout((()=>{r({type:"remove"}),s=!1,u=setInterval((()=>{document.querySelectorAll(".item").forEach((e=>{n(e)})),setTimeout((()=>{a()}),0)}),150)}),0)}),0)))};let u;t.addEventListener("keypress",(function(e){"Enter"===e.key&&c()})),l.addEventListener("click",(function(){c()})),window.addEventListener("resize",(function(e){o()}));